{% extends 'base.html' %}
{% load static %}
{% load thai_filters %}

{% block title %}{{ SITE_NAME }} - ‡∏ú‡∏•‡∏¥‡∏ï‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡∏∏‡∏°‡∏ä‡∏ô{% endblock %}

{% block content %}
<!-- Banner Carousel -->
{% if banners %}
<section class="relative overflow-hidden bg-gray-900"
         x-data="{
             currentSlide: 0,
             autoplay: null,
             totalSlides: {{ banners|length }},
             init() {
                 this.startAutoplay();
             },
             startAutoplay() {
                 this.autoplay = setInterval(() => {
                     this.next();
                 }, 5000);
             },
             stopAutoplay() {
                 clearInterval(this.autoplay);
             },
             restartAutoplay() {
                 this.stopAutoplay();
                 this.startAutoplay();
             },
             next() {
                 this.currentSlide = (this.currentSlide + 1) % this.totalSlides;
             },
             prev() {
                 this.currentSlide = (this.currentSlide - 1 + this.totalSlides) % this.totalSlides;
             },
             goTo(index) {
                 this.currentSlide = index;
                 this.restartAutoplay();
             }
         }"
         @mouseenter="stopAutoplay()"
         @mouseleave="startAutoplay()">

    <!-- Slides -->
    <div class="relative w-full aspect-[21/9]">
        {% for banner in banners %}
        <div class="absolute inset-0 transition-opacity duration-700"
             x-show="currentSlide === {{ forloop.counter0 }}"
             x-transition:enter="transition ease-out duration-700"
             x-transition:enter-start="opacity-0"
             x-transition:enter-end="opacity-100"
             x-transition:leave="transition ease-in duration-700"
             x-transition:leave-start="opacity-100"
             x-transition:leave-end="opacity-0">

            <!-- Background Image -->
            <img src="{{ banner.image.url }}" alt="{{ banner.title }}"
                 class="w-full h-full object-cover">
        </div>
        {% endfor %}
    </div>

    <!-- Navigation Arrows -->
    {% if banners|length > 1 %}
    <button @click="prev()"
            class="absolute left-4 top-1/2 -translate-y-1/2 w-12 h-12 bg-white/20 hover:bg-white/30 backdrop-blur-sm rounded-full flex items-center justify-center transition group">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
        </svg>
    </button>
    <button @click="next()"
            class="absolute right-4 top-1/2 -translate-y-1/2 w-12 h-12 bg-white/20 hover:bg-white/30 backdrop-blur-sm rounded-full flex items-center justify-center transition group">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
        </svg>
    </button>

    <!-- Dot Indicators -->
    <div class="absolute bottom-6 left-0 right-0 flex justify-center space-x-2">
        {% for banner in banners %}
        <button @click="goTo({{ forloop.counter0 }})"
                class="w-3 h-3 rounded-full transition"
                :class="currentSlide === {{ forloop.counter0 }} ? 'bg-white w-8' : 'bg-white/50 hover:bg-white/75'">
        </button>
        {% endfor %}
    </div>
    {% endif %}
</section>
{% else %}
<!-- Fallback Hero Section (if no banners) -->
<section class="gradient-hero relative overflow-hidden">
    <div class="absolute inset-0 opacity-10" style="background-image: url('data:image/svg+xml,%3Csvg width=\'60\' height=\'60\' viewBox=\'0 0 60 60\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cg fill=\'none\' fill-rule=\'evenodd\'%3E%3Cg fill=\'%23ffffff\' fill-opacity=\'0.4\'%3E%3Cpath d=\'M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z\'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E');"></div>
    <div class="absolute top-20 right-20 w-64 h-64 bg-white/10 rounded-full blur-3xl"></div>
    <div class="absolute bottom-20 left-10 w-48 h-48 bg-white/10 rounded-full blur-3xl"></div>
    
    <div class="container mx-auto px-4 py-20 lg:py-32 relative z-10">
        <div class="grid lg:grid-cols-2 gap-12 items-center">
            <div class="text-white">
                {% if site_settings.hero_tag_line %}
                <span class="inline-block px-4 py-2 glass-effect rounded-full text-sm mb-6">
                    {{ site_settings.hero_tag_line }}
                </span>
                {% endif %}
                <h1 class="text-4xl lg:text-6xl font-bold mb-6 leading-tight">
                    {{ site_settings.hero_title|default:"‡∏Ñ‡∏ì‡∏∞‡πÅ‡∏û‡∏ó‡∏¢‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå" }}
                    <span class="block text-primary-200">{{ site_settings.hero_subtitle|default:"‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏ô‡∏Ñ‡∏£‡∏û‡∏ô‡∏°" }}</span>
                </h1>
                <p class="text-xl text-primary-100 mb-8 leading-relaxed">
                    {{ site_settings.hero_description|default:SITE_DESCRIPTION }}
                </p>
                <div class="flex flex-wrap gap-4">
                    {% if site_settings.hero_button1_text and site_settings.hero_button1_link %}
                    <a href="{{ site_settings.hero_button1_link }}" class="px-8 py-4 bg-white text-primary-600 rounded-full font-semibold hover:bg-primary-50 transition shadow-xl hover:shadow-2xl">
                        {{ site_settings.hero_button1_text }}
                    </a>
                    {% endif %}
                    {% if site_settings.hero_button2_text and site_settings.hero_button2_link %}
                    <a href="{{ site_settings.hero_button2_link }}" class="px-8 py-4 glass-effect text-white rounded-full font-semibold hover:bg-white/20 transition">
                        {{ site_settings.hero_button2_text }}
                    </a>
                    {% endif %}
                </div>
            </div>
            <div class="relative hidden lg:block">
                <div class="w-80 h-80 glass-effect rounded-3xl mx-auto flex items-center justify-center" style="animation: float 3s ease-in-out infinite;">
                    <div class="text-center text-white">
                        <div class="text-8xl mb-4">üë®‚Äç‚öïÔ∏è</div>
                        <p class="text-xl font-medium">Faculty of Medicine</p>
                        <p class="text-primary-200">Nakhon Phanom University</p>
                    </div>
                </div>
                <div class="absolute top-10 -left-10 glass-effect px-4 py-2 rounded-full text-white text-sm">
                    ‚ú® ‡πÅ‡∏û‡∏ó‡∏¢‡∏™‡∏†‡∏≤‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á
                </div>
                <div class="absolute bottom-10 -right-5 glass-effect px-4 py-2 rounded-full text-white text-sm">
                    üéì ‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£ 6 ‡∏õ‡∏µ
                </div>
            </div>
        </div>
    </div>
</section>
{% endif %}

<style>
@keyframes float {
    0%, 100% { transform: translateY(0px); }
    50% { transform: translateY(-10px); }
}
</style>

<!-- Quick Links -->
<section class="py-16 bg-gray-50">
    <div class="container mx-auto px-4">
        <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
            <a href="{% url 'education:admission_list' %}" class="card-hover bg-white p-6 rounded-2xl text-center shadow-sm border border-gray-100 group">
                <div class="w-14 h-14 bg-primary-100 rounded-xl mx-auto mb-4 flex items-center justify-center group-hover:bg-primary-500 transition">
                    <span class="text-2xl">üìã</span>
                </div>
                <h3 class="font-semibold text-gray-800 group-hover:text-primary-600 transition">‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h3>
            </a>
            <a href="{% url 'education:program_list' %}" class="card-hover bg-white p-6 rounded-2xl text-center shadow-sm border border-gray-100 group">
                <div class="w-14 h-14 bg-primary-100 rounded-xl mx-auto mb-4 flex items-center justify-center group-hover:bg-primary-500 transition">
                    <span class="text-2xl">üìö</span>
                </div>
                <h3 class="font-semibold text-gray-800 group-hover:text-primary-600 transition">‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£</h3>
            </a>
            <a href="#" class="card-hover bg-white p-6 rounded-2xl text-center shadow-sm border border-gray-100 group">
                <div class="w-14 h-14 bg-primary-100 rounded-xl mx-auto mb-4 flex items-center justify-center group-hover:bg-primary-500 transition">
                    <span class="text-2xl">üî¨</span>
                </div>
                <h3 class="font-semibold text-gray-800 group-hover:text-primary-600 transition">‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡∏à‡∏±‡∏¢</h3>
            </a>
            <a href="#" class="card-hover bg-white p-6 rounded-2xl text-center shadow-sm border border-gray-100 group">
                <div class="w-14 h-14 bg-primary-100 rounded-xl mx-auto mb-4 flex items-center justify-center group-hover:bg-primary-500 transition">
                    <span class="text-2xl">üè•</span>
                </div>
                <h3 class="font-semibold text-gray-800 group-hover:text-primary-600 transition">‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•</h3>
            </a>
            <a href="#" class="card-hover bg-white p-6 rounded-2xl text-center shadow-sm border border-gray-100 group">
                <div class="w-14 h-14 bg-primary-100 rounded-xl mx-auto mb-4 flex items-center justify-center group-hover:bg-primary-500 transition">
                    <span class="text-2xl">üíö</span>
                </div>
                <h3 class="font-semibold text-gray-800 group-hover:text-primary-600 transition">‡∏ö‡∏£‡∏¥‡∏à‡∏≤‡∏Ñ</h3>
            </a>
            <a href="{% url 'core:contact' %}" class="card-hover bg-white p-6 rounded-2xl text-center shadow-sm border border-gray-100 group">
                <div class="w-14 h-14 bg-primary-100 rounded-xl mx-auto mb-4 flex items-center justify-center group-hover:bg-primary-500 transition">
                    <span class="text-2xl">üìû</span>
                </div>
                <h3 class="font-semibold text-gray-800 group-hover:text-primary-600 transition">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤</h3>
            </a>
        </div>
    </div>
</section>

<!-- SDG Section -->
<section class="py-12 md:py-16 bg-gradient-to-r from-primary-50 via-blue-50 to-green-50 relative overflow-hidden">
    <!-- Decorative Background Elements -->
    <div class="absolute top-0 left-0 w-64 h-64 bg-green-200/30 rounded-full blur-3xl -translate-y-1/2 -translate-x-1/2"></div>
    <div class="absolute bottom-0 right-0 w-64 h-64 bg-blue-200/30 rounded-full blur-3xl translate-y-1/2 translate-x-1/2"></div>

    <div class="container mx-auto px-4 relative z-10">
        <!-- Image Container -->
        <div class="max-w-6xl mx-auto">
            <img src="{% static 'images/sdg/sdg.png' %}"
                 alt="Sustainable Development Goals - SDG 3 ‡πÅ‡∏•‡∏∞ SDG 4"
                 class="w-full h-auto transition-transform duration-500 hover:scale-[1.02]">
        </div>
    </div>
</section>

<!-- News Section -->
<section class="py-20 bg-white">
    <div class="container mx-auto px-4">
        <div class="flex items-center justify-between mb-12">
            <div>
                <span class="inline-block px-3 py-1 bg-primary-100 text-primary-600 rounded-full text-sm font-medium mb-3">NEWS</span>
                <h2 class="text-3xl font-bold text-gray-800 mb-2">‡∏Ç‡πà‡∏≤‡∏ß‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå</h2>
                <p class="text-gray-500">‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Ç‡πà‡∏≤‡∏ß‡∏™‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏ì‡∏∞</p>
            </div>
            <a href="{% url 'news:list' %}" class="text-primary-500 hover:text-primary-600 font-medium flex items-center gap-2 group">
                ‡∏î‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                <svg class="w-5 h-5 group-hover:translate-x-1 transition" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
                </svg>
            </a>
        </div>
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
            {% for news in latest_news %}
            <article class="card-hover bg-white rounded-2xl overflow-hidden shadow-sm border border-gray-100">
                <div class="h-48 bg-gradient-to-br from-primary-400 to-primary-600 flex items-center justify-center relative overflow-hidden">
                    {% if news.featured_image %}
                    <img src="{{ news.featured_image.url }}" alt="{{ news.title }}" class="w-full h-full object-cover">
                    {% else %}
                    <span class="text-6xl">üì∞</span>
                    {% endif %}
                </div>
                <div class="p-6">
                    {% if news.category %}
                    <span class="inline-block px-3 py-1 bg-primary-100 text-primary-600 rounded-full text-xs font-medium mb-3">{{ news.category.name }}</span>
                    {% endif %}
                    <h3 class="text-lg font-bold text-gray-800 mb-2 line-clamp-2 hover:text-primary-600 transition">
                        <a href="{{ news.get_absolute_url }}">{{ news.title }}</a>
                    </h3>
                    <p class="text-gray-500 text-sm mb-4 line-clamp-2">{{ news.excerpt|striptags }}</p>
                    <div class="flex items-center justify-between">
                        <span class="text-sm text-gray-400">{{ news.published_at|thai_date }}</span>
                        <a href="{{ news.get_absolute_url }}" class="text-primary-500 hover:text-primary-600 text-sm font-medium">‡∏≠‡πà‡∏≤‡∏ô‡∏ï‡πà‡∏≠ ‚Üí</a>
                    </div>
                </div>
            </article>
            {% empty %}
            <div class="col-span-3 text-center py-12 text-gray-500">
                <p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πà‡∏≤‡∏ß‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå</p>
            </div>
            {% endfor %}
        </div>
    </div>
</section>

<!-- Statistics Section -->
<section class="py-20 bg-primary-50 relative overflow-hidden">
    <div class="absolute top-0 right-0 w-96 h-96 bg-primary-200/50 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2"></div>
    <div class="absolute bottom-0 left-0 w-64 h-64 bg-primary-300/30 rounded-full blur-3xl translate-y-1/2 -translate-x-1/2"></div>
    
    <div class="container mx-auto px-4 relative z-10">
        <div class="text-center mb-16">
            <span class="inline-block px-3 py-1 bg-primary-200 text-primary-700 rounded-full text-sm font-medium mb-3">STATISTICS</span>
            <h2 class="text-3xl font-bold text-gray-800 mb-4">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏ì‡∏∞‡πÅ‡∏û‡∏ó‡∏¢‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå</h2>
            <p class="text-gray-500 max-w-2xl mx-auto">‡∏°‡∏∏‡πà‡∏á‡∏°‡∏±‡πà‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡πÉ‡∏ä‡πâ‡∏ä‡∏∏‡∏°‡∏ä‡∏ô</p>
        </div>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-8">
            <div class="text-center group">
                <div class="w-24 h-24 bg-white rounded-3xl mx-auto mb-4 flex items-center justify-center shadow-lg group-hover:shadow-xl group-hover:scale-105 transition-all duration-300">
                    <span class="text-5xl">üë®‚Äçüè´</span>
                </div>
                <div class="text-5xl font-bold text-primary-600 mb-2">{{ stats.faculty }}<span class="text-3xl">+</span></div>
                <div class="text-gray-600 font-medium">‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå‡πÅ‡∏û‡∏ó‡∏¢‡πå</div>
            </div>
            <div class="text-center group">
                <div class="w-24 h-24 bg-white rounded-3xl mx-auto mb-4 flex items-center justify-center shadow-lg group-hover:shadow-xl group-hover:scale-105 transition-all duration-300">
                    <span class="text-5xl">üë®‚Äç‚öïÔ∏è</span>
                </div>
                <div class="text-5xl font-bold text-primary-600 mb-2">{{ stats.students }}<span class="text-3xl">+</span></div>
                <div class="text-gray-600 font-medium">‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏û‡∏ó‡∏¢‡πå</div>
            </div>
            <div class="text-center group">
                <div class="w-24 h-24 bg-white rounded-3xl mx-auto mb-4 flex items-center justify-center shadow-lg group-hover:shadow-xl group-hover:scale-105 transition-all duration-300">
                    <span class="text-5xl">üìë</span>
                </div>
                <div class="text-5xl font-bold text-primary-600 mb-2">{{ stats.research }}<span class="text-3xl">+</span></div>
                <div class="text-gray-600 font-medium">‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡∏à‡∏±‡∏¢</div>
            </div>
            <div class="text-center group">
                <div class="w-24 h-24 bg-white rounded-3xl mx-auto mb-4 flex items-center justify-center shadow-lg group-hover:shadow-xl group-hover:scale-105 transition-all duration-300">
                    <span class="text-5xl">üèÜ</span>
                </div>
                <div class="text-5xl font-bold text-primary-600 mb-2">{{ stats.programs }}</div>
                <div class="text-gray-600 font-medium">‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£</div>
            </div>
        </div>
    </div>
</section>

<!-- CTA Section -->
<section class="py-16 gradient-hero relative overflow-hidden">
    <div class="container mx-auto px-4 text-center relative z-10">
        <h2 class="text-3xl md:text-4xl font-bold text-white mb-4">‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡πâ‡∏≤‡∏ß‡∏™‡∏π‡πà‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡πÅ‡∏û‡∏ó‡∏¢‡πå?</h2>
        <p class="text-primary-100 text-lg mb-8 max-w-2xl mx-auto">
            ‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÅ‡∏•‡πâ‡∏ß‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ
        </p>
        <div class="flex flex-wrap justify-center gap-4">
            <a href="{% url 'education:admission_list' %}" class="px-8 py-4 bg-white text-primary-600 rounded-full font-semibold hover:bg-primary-50 transition shadow-xl">
                ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏•‡∏¢
            </a>
            <a href="{% url 'education:program_list' %}" class="px-8 py-4 glass-effect text-white rounded-full font-semibold hover:bg-white/20 transition">
                ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£
            </a>
        </div>
    </div>
</section>

<!-- Popup Modal -->
{% if popup %}
<div x-data="{
    showPopup: false,
    countdown: {{ popup.auto_close_delay }},
    countdownInterval: null,

    init() {
        if (!this.shouldShowPopup()) return;

        setTimeout(() => {
            this.showPopup = true;
            this.incrementView();
            if ({{ popup.auto_close_delay }} > 0) {
                this.startAutoClose();
            }
        }, {{ popup.show_delay }} * 1000);
    },

    shouldShowPopup() {
        const frequency = '{{ popup.show_frequency }}';
        const popupId = '{{ popup.id }}';

        if (frequency === 'once_per_session') {
            if (sessionStorage.getItem('popup_shown_' + popupId)) return false;
            sessionStorage.setItem('popup_shown_' + popupId, 'true');
        }

        if (frequency === 'once_per_day') {
            const lastShown = localStorage.getItem('popup_last_shown_' + popupId);
            const today = new Date().toDateString();
            if (lastShown === today) return false;
            localStorage.setItem('popup_last_shown_' + popupId, today);
        }

        if (frequency === 'once_forever') {
            if (localStorage.getItem('popup_forever_' + popupId)) return false;
            localStorage.setItem('popup_forever_' + popupId, 'true');
        }

        return true;
    },

    startAutoClose() {
        this.countdownInterval = setInterval(() => {
            this.countdown--;
            if (this.countdown <= 0) {
                this.closePopup();
            }
        }, 1000);
    },

    closePopup() {
        if (this.countdownInterval) {
            clearInterval(this.countdownInterval);
        }
        this.showPopup = false;
    },

    incrementView() {
        fetch('/api/popup/{{ popup.id }}/view/', {
            method: 'POST',
            headers: {
                'X-CSRFToken': '{{ csrf_token }}'
            }
        });
    },

    incrementClick() {
        fetch('/api/popup/{{ popup.id }}/click/', {
            method: 'POST',
            headers: {
                'X-CSRFToken': '{{ csrf_token }}'
            }
        });
    }
}"
@keydown.escape.window="closePopup()">
    <!-- Overlay -->
    <div x-show="showPopup"
         x-transition:enter="transition ease-out duration-300"
         x-transition:enter-start="opacity-0"
         x-transition:enter-end="opacity-100"
         x-transition:leave="transition ease-in duration-200"
         x-transition:leave-start="opacity-100"
         x-transition:leave-end="opacity-0"
         class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4"
         @click="closePopup()"
         style="display: none;">

        <!-- Modal -->
        <div @click.stop
             x-transition:enter="transition ease-out duration-300"
             x-transition:enter-start="opacity-0 scale-95"
             x-transition:enter-end="opacity-100 scale-100"
             x-transition:leave="transition ease-in duration-200"
             x-transition:leave-start="opacity-100 scale-100"
             x-transition:leave-end="opacity-0 scale-95"
             class="bg-white rounded-2xl shadow-2xl relative w-full p-4
                    {% if popup.size == 'small' %}max-w-[640px]{% elif popup.size == 'large' %}max-w-[1280px]{% else %}max-w-[800px]{% endif %}">

            <!-- Close Button -->
            <button @click="closePopup()"
                    class="absolute top-6 right-6 z-10 w-10 h-10 bg-white/90 hover:bg-white rounded-full flex items-center justify-center text-gray-600 hover:text-gray-800 transition shadow-lg">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>

            <!-- Countdown Badge (if auto-close enabled) -->
            <div x-show="{{ popup.auto_close_delay }} > 0"
                 class="absolute top-6 left-6 z-10 bg-primary-600 text-white px-3 py-1 rounded-full text-sm font-semibold shadow-lg">
                ‡∏õ‡∏¥‡∏î‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÉ‡∏ô <span x-text="countdown"></span> ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
            </div>

            <!-- Image -->
            <div class="relative rounded-lg overflow-hidden">
                <img src="{{ popup.image.url }}" alt="{{ popup.title }}"
                     class="w-full aspect-video object-cover">
            </div>

            <!-- Content (if link provided) -->
            {% if popup.link_url %}
            <div class="p-6 text-center">
                <a href="{{ popup.link_url }}"
                   @click="incrementClick()"
                   class="inline-block px-8 py-4 bg-primary-600 hover:bg-primary-700 text-white rounded-full font-semibold transition shadow-xl hover:shadow-2xl">
                    {{ popup.link_text }}
                    <svg class="inline w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
                    </svg>
                </a>
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endif %}

{% endblock %}
